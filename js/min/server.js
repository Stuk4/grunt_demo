var express=require("express"),app=express(),bodyparser=require("body-parser"),mongoose=require("mongoose");mongoose.connect("mongodb://localhost:27017/test");var http=require("http"),auth=require("basic-auth");app.use(function(req,res,next){var user=auth(req);void 0===user||"username"!==user.name||"password"!==user.pass?(res.statusCode=401,res.setHeader("WWW-Authenticate",'Basic realm="MyRealmName"'),res.end("Unauthorized")):next()}),app.use(bodyparser.urlencoded({extended:!0})),app.use(bodyparser.json());var port=process.env.PORT||8080,Bear=require("./model/bear"),router=express.Router();router.get("/",function(req,res){res.json({message:"Hi"})}),router.route("/bears/:bear_id").get(function(req,res){Bear.findById(req.params.bear_id,function(err,bear){err&&res.send(err),res.json(bear)})}),router.route("/bears").post(function(req,res){var bear=new Bear;bear.name=req.body.name,bear.save(function(err){err&&res.send(err),res.json({message:"Bear Created!"})})}).get(function(req,res){Bear.find(function(err,bears){err&&res.send(err),res.json(bears)})}),app.use("/api",router),app.listen(port);